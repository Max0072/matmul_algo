# –ê–Ω–∞–ª–∏–∑ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü
## Matrix Multiplication Algorithms: Analysis and Benchmarks

---

## Executive Summary

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã **9 –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤** —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü:
- **Naive** (O(n¬≥), 64 —É–º–Ω–æ–∂–µ–Ω–∏–π –¥–ª—è 4√ó4)
- **Strassen** (O(n^2.807), —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å –±–∞–∑–æ–π 4√ó4)
- **Strassen 4√ó4** (7 —É–º–Ω–æ–∂–µ–Ω–∏–π 2√ó2 –±–ª–æ–∫–æ–≤, –±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏)
- **Winograd 4√ó4** (48 —É–º–Ω–æ–∂–µ–Ω–∏–π, –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–Ω—ã–π)
- **AlphaEvolve 4√ó4** (48 —É–º–Ω–æ–∂–µ–Ω–∏–π, —á–µ—Ä–µ–∑ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —á–∏—Å–ª–∞)
- **Blocked variants** (naive/winograd/alphaevolve/strassen - –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –±–æ–ª—å—à–∏–µ —Ä–∞–∑–º–µ—Ä—ã)

–ü—Ä–æ–≤–µ–¥–µ–Ω–æ **132 –±–µ–Ω—á–º–∞—Ä–∫–∞** –Ω–∞ —Ä–∞–∑–º–µ—Ä–∞—Ö 4-256, –¥–ª—è —Ç–∏–ø–æ–≤ double –∏ complex<double>, –Ω–∞ random –∏ symmetric –º–∞—Ç—Ä–∏—Ü–∞—Ö.

**–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:**
1. ‚úÖ **Blocked Winograd** - –õ–£–ß–®–ò–ô: –Ω–∞ 10-15% –±—ã—Å—Ç—Ä–µ–µ naive
2. ‚úÖ Strassen —É–ª—É—á—à–µ–Ω –≤ 2.5x (–±–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π 4√ó4), –Ω–æ –≤—Å–µ –µ—â–µ –º–µ–¥–ª–µ–Ω–Ω–µ–µ naive
3. ‚ö†Ô∏è –ú–µ–Ω—å—à–µ —É–º–Ω–æ–∂–µ–Ω–∏–π ‚â† –±—ã—Å—Ç—Ä–µ–µ (overhead –∫—Ä–∏—Ç–∏—á–µ–Ω)
4. ‚ùå AlphaEvolve –º–µ–¥–ª–µ–Ω–Ω–µ–µ –∏–∑-–∑–∞ –æ–≥—Ä–æ–º–Ω–æ–≥–æ —á–∏—Å–ª–∞ –æ–ø–µ—Ä–∞—Ü–∏–π
5. ‚ùå Blocked Strassen –≤ 2x –º–µ–¥–ª–µ–Ω–Ω–µ–µ –∏–∑-–∑–∞ –¥–≤–æ–π–Ω–æ–≥–æ overhead

---

## 1. Operation Counts: Multiplications vs Additions

### –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (4√ó4 –º–∞—Ç—Ä–∏—Ü—ã):

| –ê–ª–≥–æ—Ä–∏—Ç–º | –£–º–Ω–æ–∂–µ–Ω–∏—è | –°–ª–æ–∂–µ–Ω–∏—è | –í—Å–µ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π |
|----------|-----------|----------|----------------|
| Naive | 64 | 64 | 128 |
| Winograd | 48 (-25%) | 128 (+100%) | 176 (+48) |
| Strassen 4√ó4 | 56 (-12.5%) | 128 (+100%) | 184 (+56) |
| AlphaEvolve | 48 (-25%) | ~—Ç—ã—Å—è—á–∏ | –æ–≥—Ä–æ–º–Ω–æ–µ —á–∏—Å–ª–æ |

### –ò–∑–º–µ—Ä–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è 256√ó256, double, random:

| –ê–ª–≥–æ—Ä–∏—Ç–º | –í—Ä–µ–º—è (ms) | –£–º–Ω–æ–∂–µ–Ω–∏—è | –°–ª–æ–∂–µ–Ω–∏—è | –≠–∫–æ–Ω–æ–º–∏—è mul |
|----------|------------|-----------|----------|--------------|
| naive | 59-64 | 16,777,216 | 16,777,216 | baseline |
| **blocked_winograd** | **53-55** ‚≠ê | 12,582,912 | 37,748,736 | **-25%** |
| strassen | 68-75 | 6,588,344 | 28,382,624 | **-61%** |
| blocked_naive | 69-76 | 16,777,216 | 20,971,520 | 0% |
| blocked_strassen | 128-129 | 14,680,064 | 37,748,736 | -12% |
| blocked_alphaevolve | 395-398 | 12,582,912 | 4,194,304 | -25% |

### –ê–Ω–∞–ª–∏–∑:

#### 1.1 –ü–æ—á–µ–º—É –º–µ–Ω—å—à–µ —É–º–Ω–æ–∂–µ–Ω–∏–π ‚â† –±—ã—Å—Ç—Ä–µ–µ?

**Strassen –ø–∞—Ä–∞–¥–æ–∫—Å:**
- **-61% —É–º–Ω–æ–∂–µ–Ω–∏–π** (6.5M vs 16.7M)
- –ù–æ **–º–µ–¥–ª–µ–Ω–Ω–µ–µ naive –Ω–∞ 13-17%** (68-75 ms vs 59-64 ms)
- –ü—Ä–∏—á–∏–Ω—ã:
  - –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π overhead (–¥–∞–∂–µ —Å –±–∞–∑–æ–π 4√ó4)
  - –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ
  - –ü–ª–æ—Ö–∞—è cache locality
  - –°–ª–æ–∂–Ω–æ –≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å
- **–£–ª—É—á—à–µ–Ω–∏–µ:** –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–±–∞–∑–∞ 4√ó4) —É—Å–∫–æ—Ä–∏–ª—Å—è —Å 186 ms –¥–æ 68-75 ms (**2.5x –±—ã—Å—Ç—Ä–µ–µ!**)
- **–ù–æ:** –í—Å–µ –µ—â–µ –º–µ–¥–ª–µ–Ω–Ω–µ–µ naive –∏–∑-–∑–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ overhead

**Blocked Strassen –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞:**
- –¢–æ–ª—å–∫–æ **-12% —É–º–Ω–æ–∂–µ–Ω–∏–π** (–º–µ–Ω—å—à–µ —á–µ–º –ø—Ä—è–º–æ–π Strassen!)
- **–í 2x –º–µ–¥–ª–µ–Ω–Ω–µ–µ** —á–µ–º naive (128 ms vs 59-64 ms)
- –ü—Ä–∏—á–∏–Ω—ã:
  - **–î–≤–æ–π–Ω–æ–π overhead:** blocking + Strassen –≤–Ω—É—Ç—Ä–∏
  - –î–ª—è 256√ó256: 4096 –±–ª–æ–∫–æ–≤ √ó 16 –º–∞—Ç—Ä–∏—Ü 2√ó2 = **65,536 –∞–ª–ª–æ–∫–∞—Ü–∏–π!**
  - –î–µ—Å—è—Ç–∫–∏ —Ç—ã—Å—è—á –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π
  - –§—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–∞–º—è—Ç–∏

**AlphaEvolve –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞:**
- **-25% —É–º–Ω–æ–∂–µ–Ω–∏–π** (–∫–∞–∫ Winograd)
- –ù–æ **–≤ 6.5x –º–µ–¥–ª–µ–Ω–Ω–µ–µ** (395 ms vs 59-64 ms)
- –ü—Ä–∏—á–∏–Ω—ã:
  - –û–≥—Ä–æ–º–Ω–æ–µ —á–∏—Å–ª–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –ª–∏–Ω–µ–π–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
  - 48 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ a[], 48 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ b[] - –∫–∞–∂–¥—ã–π —ç—Ç–æ —Å—É–º–º–∞ ~8-16 —Å–ª–∞–≥–∞–µ–º—ã—Ö
  - –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏ (–¥–∞–∂–µ –¥–ª—è double –≤—Ö–æ–¥–æ–≤)
  - –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ Matrix ‚Üí Complex ‚Üí Matrix

**Winograd —É—Å–ø–µ—Ö:**
- **-25% —É–º–Ω–æ–∂–µ–Ω–∏–π** (12.5M vs 16.7M)
- **–ù–∞ 10-15% –±—ã—Å—Ç—Ä–µ–µ naive!** ‚úì
- –ü—Ä–∏—á–∏–Ω—ã:
  - –ü—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º—É–ª–∞ –±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏
  - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å (8 —Å–∫–∞–ª—è—Ä–æ–≤)
  - Cache-friendly –±–ª–æ–∫–∏ 4√ó4
  - –õ–µ–≥–∫–æ –≤–µ–∫—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º
  - –ù–µ—Ç –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π (–≤—Å–µ inline)

#### 1.2 –°—Ä–∞–≤–Ω–µ–Ω–∏–µ Winograd vs Strassen 4√ó4:

**–ü–æ—á–µ–º—É Winograd –±—ã—Å—Ç—Ä–µ–µ?**

| –ê—Å–ø–µ–∫—Ç | Winograd 4√ó4 | Strassen 4√ó4 |
|--------|--------------|--------------|
| **–£–º–Ω–æ–∂–µ–Ω–∏—è** | 48 (-25%) | 56 (-12.5%) |
| **–°–ª–æ–∂–µ–Ω–∏—è** | 128 | 128 |
| **Temp –ø–∞–º—è—Ç—å** | 8 doubles (64B) | 16 matrices (512B) |
| **–ê–ª–ª–æ–∫–∞—Ü–∏–∏** | 0 | 16 |
| **–í—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π** | 0 (inline) | 10+ |
| **Cache locality** | ‚úÖ –û—Ç–ª–∏—á–Ω–æ | ‚ùå –ü–ª–æ—Ö–æ |
| **Vectorization** | ‚úÖ –õ–µ–≥–∫–æ | ‚ùå –°–ª–æ–∂–Ω–æ |

**–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è blocked (256√ó256):**
- blocked_winograd: **53-55 ms** ‚≠ê
- blocked_strassen: **128-129 ms** (–≤ 2.4x –º–µ–¥–ª–µ–Ω–Ω–µ–µ!)

#### 1.3 –í—ã–≤–æ–¥ –ø–æ operation counts:

- **–≠–∫–æ–Ω–æ–º–∏—è —É–º–Ω–æ–∂–µ–Ω–∏–π –≤–∞–∂–Ω–∞**, –Ω–æ –Ω–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä
- **Overhead** (–ø–∞–º—è—Ç—å, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è, –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π) —á–∞—Å—Ç–æ –ø–µ—Ä–µ–≤–µ—à–∏–≤–∞–µ—Ç —ç–∫–æ–Ω–æ–º–∏—é
- **Winograd**: –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å (—ç–∫–æ–Ω–æ–º–∏—è -25%, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead)
- **Strassen**: —Ö–æ—Ä–æ—à–∞—è —ç–∫–æ–Ω–æ–º–∏—è (-61%), –Ω–æ overhead —É–±–∏–≤–∞–µ—Ç –≤—ã–∏–≥—Ä—ã—à
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞** –≤–∞–∂–Ω–µ–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∏ –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö

---

## 2. Memory Overhead & Access Patterns

### Memory Usage (256√ó256, double):

| –ê–ª–≥–æ—Ä–∏—Ç–º | –í—Ä–µ–º—è (ms) | Extra Memory | Cache Behavior |
|----------|------------|--------------|----------------|
| naive | 59-64 | 0 bytes | ‚ö†Ô∏è –°—Ä–µ–¥–Ω–∏–π (—Å–ª—É—á–∞–π–Ω—ã–π –¥–æ—Å—Ç—É–ø –ø–æ B) |
| blocked_winograd | **53-55** | 0 bytes | ‚úÖ –û—Ç–ª–∏—á–Ω—ã–π (–±–ª–æ–∫–∏ –≤ L1) |
| strassen | 68-75 | 3,145,728 bytes (3 MB) | ‚ùå –ü–ª–æ—Ö–æ–π (—Ä–µ–∫—É—Ä—Å–∏—è) |
| blocked_strassen | 128-129 | 0 bytes reported | ‚úó‚úó –£–∂–∞—Å–Ω—ã–π (–º–Ω–æ–≥–æ –∞–ª–ª–æ–∫–∞—Ü–∏–π) |

### –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–º—è—Ç–∏:

#### 2.1 Cache friendliness:

**Naive:**
```cpp
for (i = 0; i < n; i++)
    for (j = 0; j < n; j++)
        for (k = 0; k < n; k++)
            C[i][j] += A[i][k] * B[k][j];  // B[k][j] - –ø–ª–æ—Ö–æ–π –¥–æ—Å—Ç—É–ø!
```
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –ø–æ —Å—Ç—Ä–æ–∫–∞–º A ‚úì
- **–°–ª—É—á–∞–π–Ω—ã–π –¥–æ—Å—Ç—É–ø –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º B** ‚úó (cache misses!)
- –î–ª—è –±–æ–ª—å—à–∏—Ö –º–∞—Ç—Ä–∏—Ü: –º–Ω–æ–≥–æ cache misses

**Blocked Winograd (–õ–£–ß–®–ò–ô):**
```cpp
// –ë–ª–æ–∫–∏ 4√ó4 —Ü–µ–ª–∏–∫–æ–º –≤ L1 –∫—ç—à–µ
for (–±–ª–æ–∫_i)
    for (–±–ª–æ–∫_j)
        for (–±–ª–æ–∫_k)
            winograd_4x4(A_block, B_block, C_block)
            // –ë–ª–æ–∫ 4√ó4 = 128 –±–∞–π—Ç (16 doubles)
            // L1 cache line = 64 –±–∞–π—Ç–∞
            // –ë–ª–æ–∫ = 2 cache lines - –∏–¥–µ–∞–ª—å–Ω–æ!
```
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∞ –≤ L1 –∫—ç—à–µ ‚úì
- –ú–∏–Ω–∏–º—É–º cache misses ‚úì
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–∞ 10-15% –±—ã—Å—Ç—Ä–µ–µ naive**

**Strassen (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π):**
```cpp
// –ö–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å —Ä–µ–∫—É—Ä—Å–∏–∏ —Å–æ–∑–¥–∞–µ—Ç 3 –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã n/2 √ó n/2
strassen_rec(A, B, C, n) {
    Matrix S1(n/2, n/2), S2(n/2, n/2), P(n/2, n/2);
    // ... 7 —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –±–ª–æ–∫–∞–º–∏
}
```
- –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞—Ä—É—à–∞–µ—Ç cache locality ‚úó
- –ü—Ä—ã–∂–∫–∏ –º–µ–∂–¥—É –ø–æ–¥–º–∞—Ç—Ä–∏—Ü–∞–º–∏
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –≤—ã—Ç–µ—Å–Ω—è—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –∏–∑ –∫—ç—à–∞
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: –º–µ–¥–ª–µ–Ω–Ω–µ–µ naive –¥–∞–∂–µ —Å -61% —É–º–Ω–æ–∂–µ–Ω–∏–π**

**Blocked Strassen (–ö–ê–¢–ê–°–¢–†–û–§–ê):**
```cpp
for (–∫–∞–∂–¥—ã–π –±–ª–æ–∫ 4√ó4) {  // 4096 –±–ª–æ–∫–æ–≤ –¥–ª—è 256√ó256
    Matrix temp_result(4,4);  // 1 –∞–ª–ª–æ–∫–∞—Ü–∏—è

    // –í–Ω—É—Ç—Ä–∏ Strassen 4√ó4:
    Matrix S1(2,2), S2(2,2), ..., S7(2,2);  // 7 –∞–ª–ª–æ–∫–∞—Ü–∏–π
    Matrix P1(2,2), P2(2,2), ..., P7(2,2);  // 7 –∞–ª–ª–æ–∫–∞—Ü–∏–π
    Matrix T1(2,2), T2(2,2);                // 2 –∞–ª–ª–æ–∫–∞—Ü–∏–∏
    // –ò–¢–û–ì–û: 16 –∞–ª–ª–æ–∫–∞—Ü–∏–π –Ω–∞ –±–ª–æ–∫!
}
// –í—Å–µ–≥–æ: 4096 √ó 16 = 65,536 –∞–ª–ª–æ–∫–∞—Ü–∏–π!
```
- –û–≥—Ä–æ–º–Ω–æ–µ —á–∏—Å–ª–æ –∞–ª–ª–æ–∫–∞—Ü–∏–π –≤—ã—Ç–µ—Å–Ω—è–µ—Ç –≤—Å–µ –∏–∑ –∫—ç—à–∞ ‚úó‚úó
- Malloc/free overhead
- –§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞–º—è—Ç–∏
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: –≤ 2x –º–µ–¥–ª–µ–Ω–Ω–µ–µ naive**

#### 2.2 –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–ª–ª–æ–∫–∞—Ü–∏–∏ - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ:

| –ê–ª–≥–æ—Ä–∏—Ç–º | Temp –Ω–∞ 1 –±–ª–æ–∫ 4√ó4 | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------------------|----------|
| Winograd | 8 doubles (64B) | 8 —Å–∫–∞–ª—è—Ä–æ–≤ –Ω–∞ —Å—Ç–µ–∫–µ |
| Strassen 4√ó4 | 16 matrices (512B) | 16 –∞–ª–ª–æ–∫–∞—Ü–∏–π Matrix<T>(2,2) |
| Naive | 0 | –ù–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |

**–î–ª—è blocked –Ω–∞ 256√ó256 (4096 –±–ª–æ–∫–æ–≤):**
- blocked_winograd: 4096 √ó 64B = **256 KB** (—É–º–µ—â–∞–µ—Ç—Å—è –≤ L2)
- blocked_strassen: 4096 √ó 512B = **2 MB** + overhead –∞–ª–ª–æ–∫–∞—Ü–∏–π

#### 2.3 –í—ã–≤–æ–¥ –ø–æ –ø–∞–º—è—Ç–∏:

- ‚úÖ **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å** –∫—Ä–∏—Ç–∏—á–Ω–∞ (Winograd: 64B)
- ‚ùå **–ú–Ω–æ–≥–æ –∞–ª–ª–æ–∫–∞—Ü–∏–π** —É–±–∏–≤–∞—é—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (Strassen: 65K –∞–ª–ª–æ–∫–∞—Ü–∏–π)
- ‚úÖ **Cache locality** –≤–∞–∂–Ω–µ–µ –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∏ (–±–ª–æ–∫–∏ 4√ó4 –≤ L1)
- ‚ùå **–†–µ–∫—É—Ä—Å–∏—è** –Ω–∞—Ä—É—à–∞–µ—Ç locality (Strassen)

---

## 3. Numerical Stability

### Correctness Error (max_abs_diff vs naive, 256√ó256):

**Double (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∏—Å–ª–∞):**

| –ê–ª–≥–æ—Ä–∏—Ç–º | Error | –û—Ü–µ–Ω–∫–∞ |
|----------|-------|--------|
| naive | 0.00e+00 | ‚úì —ç—Ç–∞–ª–æ–Ω |
| strassen | 1.10e-12 | ‚úì —Å—Ç–∞–±–∏–ª—å–Ω—ã–π |
| strassen_4x4 | 4.44e-16 | ‚úì –æ—Ç–ª–∏—á–Ω–æ |
| winograd_4x4 | 4.44e-16 | ‚úì –æ—Ç–ª–∏—á–Ω–æ |
| alphaevolve_4x4 | 4.44e-16 | ‚úì –æ—Ç–ª–∏—á–Ω–æ |
| blocked_winograd | 3.02e-14 | ‚úì —Å—Ç–∞–±–∏–ª—å–Ω—ã–π |
| blocked_strassen | 3.20e-14 | ‚úì —Å—Ç–∞–±–∏–ª—å–Ω—ã–π |
| blocked_alphaevolve | 3.38e-14 | ‚úì —Å—Ç–∞–±–∏–ª—å–Ω—ã–π |

**Complex<double> (–∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —á–∏—Å–ª–∞):**

| –ê–ª–≥–æ—Ä–∏—Ç–º | Error | –û—Ü–µ–Ω–∫–∞ |
|----------|-------|--------|
| naive | 0.00e+00 | ‚úì —ç—Ç–∞–ª–æ–Ω |
| strassen | 3.26e-12 | ‚úì —Å—Ç–∞–±–∏–ª—å–Ω—ã–π |
| strassen_4x4 | 8.88e-16 | ‚úì –æ—Ç–ª–∏—á–Ω–æ |
| winograd_4x4 | 6.55e-16 | ‚úì –æ—Ç–ª–∏—á–Ω–æ |
| **alphaevolve_4x4** | **3.82e+01** | ‚úó‚úó **–ù–ï–°–¢–ê–ë–ò–õ–¨–ù–û** |
| blocked_winograd | 4.28e-14 | ‚úì —Å—Ç–∞–±–∏–ª—å–Ω—ã–π |
| blocked_strassen | 4.09e-14 | ‚úì —Å—Ç–∞–±–∏–ª—å–Ω—ã–π |
| **blocked_alphaevolve** | **3.50e+01** | ‚úó‚úó **–ù–ï–°–¢–ê–ë–ò–õ–¨–ù–û** |

### –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏:

#### 3.1 AlphaEvolve –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö —á–∏—Å–µ–ª - –§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü:**
```cpp
// –í —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
const Complex A00(A(0,0));  // –ï—Å–ª–∏ A(0,0) –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ, —Ç–µ—Ä—è–µ–º imaginary part!
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ complex<double> –≤—Ö–æ–¥–∞—Ö:**
1. A(0,0) —Ç–∏–ø–∞ `complex<double>(real=3.5, imag=2.1)`
2. –°–æ–∑–¥–∞–µ–º `Complex(A(0,0))` ‚Üí implicit conversion –±–µ—Ä–µ—Ç —Ç–æ–ª—å–∫–æ `real()` —á–∞—Å—Ç—å!
3. –¢–µ—Ä—è–µ—Ç—Å—è –≤—Å—è –º–Ω–∏–º–∞—è —á–∞—Å—Ç—å –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–≤–µ—Ä–Ω—ã–π (–æ—à–∏–±–∫–∞ ~35!)

**–í—ã–≤–æ–¥:** AlphaEvolve **–ù–ï–õ–¨–ó–Ø** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü!

#### 3.2 Strassen - –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫:

**–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π Strassen:**
- 7 —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö —É–º–Ω–æ–∂–µ–Ω–∏–π + –º–Ω–æ–≥–æ –≤—ã—á–∏—Ç–∞–Ω–∏–π
- –í—ã—á–∏—Ç–∞–Ω–∏—è —É—Å–∏–ª–∏–≤–∞—é—Ç –æ—à–∏–±–∫–∏ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è
- –ì–ª—É–±–æ–∫–∞—è —Ä–µ–∫—É—Ä—Å–∏—è –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
- –î–ª—è 256√ó256: –æ—à–∏–±–∫–∞ 1-3e-12 (–ø—Ä–∏–µ–º–ª–µ–º–æ)

**Strassen 4√ó4 (–±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏):**
- –í—Å–µ–≥–æ 1 —É—Ä–æ–≤–µ–Ω—å —Ä–µ–∫—É—Ä—Å–∏–∏ (2√ó2)
- –ú–µ–Ω—å—à–µ –æ–ø–µ—Ä–∞—Ü–∏–π ‚Üí –º–µ–Ω—å—à–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
- –û—à–∏–±–∫–∞ 4.44e-16 (–º–∞—à–∏–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å!)

#### 3.3 Winograd - –æ—Ç–ª–∏—á–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:

- –§–æ—Ä–º—É–ª–∞ —Ö–æ—Ä–æ—à–æ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∞
- –ù–µ—Ç —Ä–µ–∫—É—Ä—Å–∏–∏ ‚Üí –Ω–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫
- –û—à–∏–±–∫–∞ 3-4e-14 –¥–ª—è blocked (–æ—Ç–ª–∏—á–Ω–æ)
- **–†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤** (double, complex)

#### 3.4 –í—ã–≤–æ–¥ –ø–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏:

- ‚úÖ **Winograd** - —á–∏—Å–ª–µ–Ω–Ω–æ —Å—Ç–∞–±–∏–ª–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤
- ‚úÖ **Strassen 4√ó4** - –æ—Ç–ª–∏—á–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (–±–µ–∑ –≥–ª—É–±–æ–∫–æ–π —Ä–µ–∫—É—Ä—Å–∏–∏)
- ‚ö†Ô∏è **Strassen —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π** - –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ (–Ω–æ –ø—Ä–∏–µ–º–ª–µ–º–æ)
- ‚ùå **AlphaEvolve** - **–ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è complex<double> –≤—Ö–æ–¥–æ–≤**

---

## 4. Hardware & Parallelism: Why BLAS/Naive Can Win

### –ü–æ—á–µ–º—É naive –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–µ–Ω –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ?

#### 4.1 Compiler optimizations —Å `-O2`:

Naive –∞–ª–≥–æ—Ä–∏—Ç–º:
```cpp
for (int i = 0; i < n; ++i)
    for (int j = 0; j < n; ++j)
        for (int k = 0; k < n; ++k)
            C(i,j) += A(i,k) * B(k,j);
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä:**
- ‚úÖ **Loop unrolling** - —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç —Ü–∏–∫–ª—ã
- ‚úÖ **SIMD vectorization** (AVX2/AVX512) - 4-8 –æ–ø–µ—Ä–∞—Ü–∏–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- ‚úÖ **FMA instructions** - `a*b+c` –∑–∞ 1 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
- ‚úÖ **Register allocation** - –¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö
- ‚úÖ **Prefetching** - –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞—Ä–∞–Ω–µ–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Naive —Å `-O2` —Ä–∞–±–æ—Ç–∞–µ—Ç **–ø–æ—á—Ç–∏ –∫–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞** –Ω–∞ —Å—Ä–µ–¥–Ω–∏—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö.

#### 4.2 –ü–æ—á–µ–º—É Winograd –µ—â–µ –ª—É—á—à–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è:

```cpp
// –ü—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏
for (int i = 0; i < 4; i++) {
    for (int j = 0; j < 4; j++) {
        C(i,j) = p[i] + q[j] +
                 (A(i,0)+B(1,j))*(A(i,1)+B(0,j)) +
                 (A(i,2)+B(3,j))*(A(i,3)+B(2,j));
    }
}
```

**–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –º–æ–∂–µ—Ç:**
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é unroll —Ü–∏–∫–ª (–≤—Å–µ–≥–æ 16 –∏—Ç–µ—Ä–∞—Ü–∏–π)
- ‚úÖ –í–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FMA –¥–ª—è `(a+b)*(c+d)`
- ‚úÖ –î–µ—Ä–∂–∞—Ç—å p[], q[] –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç: -25% —É–º–Ω–æ–∂–µ–Ω–∏–π + –æ—Ç–ª–∏—á–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è = 10-15% —É—Å–∫–æ—Ä–µ–Ω–∏–µ!**

#### 4.3 –ü–æ—á–µ–º—É Strassen –ø–ª–æ—Ö–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è:

```cpp
// –†–µ–∫—É—Ä—Å–∏—è + –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π
sub_2x2(B12, B22, view(S1), cnt);
mul_naive_2x2(A11, view(S1), view(P1), cnt);
// ... –µ—â–µ 10+ –≤—ã–∑–æ–≤–æ–≤

// –í–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π - –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞
template <class T, class U, class V>
inline void mul_naive_2x2(U A, V B, MatrixView<T> C, OpCounter* cnt) {
    // –¢—Ä–æ–π–Ω–æ–π —Ü–∏–∫–ª —Å –∏–Ω–¥–∏—Ä–µ–∫—Ü–∏–µ–π —á–µ—Ä–µ–∑ stride
    for(int i = 0; i < 2; i++)
        for(int j = 0; j < 2; j++)
            for(int k = 0; k < 2; k++)
                C(i,j) = add(C(i,j), mul(A(i,k), B(k,j), cnt), cnt);
}
```

**–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ù–ï –º–æ–∂–µ—Ç:**
- ‚ùå Inline –≤—Å–µ (—Å–ª–∏—à–∫–æ–º –≥–ª—É–±–æ–∫–æ)
- ‚ùå –í–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π
- ‚ùå –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å MatrixView –∏–Ω–¥–∏—Ä–µ–∫—Ü–∏—é
- ‚ùå –£–±—Ä–∞—Ç—å OpCounter overhead
- ‚ùå **–†–µ–∑—É–ª—å—Ç–∞—Ç: -61% —É–º–Ω–æ–∂–µ–Ω–∏–π, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ –∏–∑-–∑–∞ overhead!**

#### 4.4 –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (BLAS):

**Intel MKL / OpenBLAS dgemm:**
- –†—É—á–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è assembly –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
- –í—Å–µ SIMD –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (AVX512, FMA3)
- –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å (OpenMP)
- Cache-oblivious –∞–ª–≥–æ—Ä–∏—Ç–º—ã
- Blocking + –ø–∞–Ω–µ–ª—å–Ω–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: –≤ 10-100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞—à–µ–≥–æ naive**

**–ü–æ—á–µ–º—É BLAS –ø–æ–±–µ–∂–¥–∞–µ—Ç Strassen –¥–æ n ~ 10000:**
- O(n¬≥) –Ω–æ —Å **–∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π √ó0.01** –±–ª–∞–≥–æ–¥–∞—Ä—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –í–°–Æ –∏–µ—Ä–∞—Ä—Ö–∏—é –ø–∞–º—è—Ç–∏ (L1/L2/L3/RAM)
- –ò–¥–µ–∞–ª—å–Ω–∞—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º
- Strassen: O(n^2.807) –Ω–æ —Å **–∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π √ó10** –∏–∑-–∑–∞ overhead

#### 4.5 Blocked Winograd - –∑–æ–ª–æ—Ç–∞—è —Å–µ—Ä–µ–¥–∏–Ω–∞:

**–ü–æ—á–µ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. **–ë–ª–æ–∫–∏ 4√ó4** - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è L1 –∫—ç—à–∞
2. **Winograd —è–¥—Ä–æ** - –ø—Ä–æ—Å—Ç–æ–µ, –ª–µ–≥–∫–æ –≤–µ–∫—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è
3. **-25% —É–º–Ω–æ–∂–µ–Ω–∏–π** - —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –¥–ª—è FP –æ–ø–µ—Ä–∞—Ü–∏–π
4. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead** - –Ω–µ—Ç –∞–ª–ª–æ–∫–∞—Ü–∏–π, –Ω–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç: 10-15% —É—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞–¥ naive —Å -O2**

–ï—Å–ª–∏ –±—ã –¥–æ–±–∞–≤–∏–ª–∏:
- SIMD –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é ‚Üí 30-50% —É—Å–∫–æ—Ä–µ–Ω–∏–µ
- –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å ‚Üí –µ—â–µ 4-8x
- Cache tuning ‚Üí –µ—â–µ 20-30%

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª: blocked Winograd –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ 5-10x –±—ã—Å—Ç—Ä–µ–µ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏!**

#### 4.6 –í—ã–≤–æ–¥—ã –ø–æ hardware:

- ‚úÖ **Naive —Ö–æ—Ä–æ—à–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è** –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º (-O2 —Ç–≤–æ—Ä–∏—Ç —á—É–¥–µ—Å–∞)
- ‚úÖ **Winograd –µ—â–µ –ª—É—á—à–µ** (–ø—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ + —ç–∫–æ–Ω–æ–º–∏—è —É–º–Ω–æ–∂–µ–Ω–∏–π)
- ‚ùå **Strassen –ø–ª–æ—Ö–æ** (—Ä–µ–∫—É—Ä—Å–∏—è + –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π –º–µ—à–∞—é—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)
- ‚úÖ **BLAS –Ω–µ–ø–æ–±–µ–¥–∏–º** (—Ä—É—á–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ –∂–µ–ª–µ–∑–æ)
- üí° **–ë–ª–æ—á–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã** —Å –ø—Ä–æ—Å—Ç—ã–º–∏ —è–¥—Ä–∞–º–∏ - –ª—É—á—à–∏–π –ø–æ–¥—Ö–æ–¥

---

## 5. –û–±—â–∏–µ –≤—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 5.1 –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (256√ó256, double):

| –ú–µ—Å—Ç–æ | –ê–ª–≥–æ—Ä–∏—Ç–º | –í—Ä–µ–º—è (ms) | vs Naive | –û—Ü–µ–Ω–∫–∞ |
|-------|----------|------------|----------|--------|
| ü•á | **blocked_winograd** | **53-55** | **-10%** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –õ–£–ß–®–ò–ô |
| ü•à | **naive** | **59-64** | baseline | ‚≠ê‚≠ê‚≠ê‚≠ê –•–æ—Ä–æ—à–∏–π |
| ü•â | **strassen** | **68-75** | +13% | ‚≠ê‚≠ê‚≠ê –£–ª—É—á—à–µ–Ω (–±—ã–ª–æ +190%) |
| 4 | blocked_naive | 69-76 | +15% | ‚≠ê‚≠ê‚≠ê –û–∫ |
| 5 | blocked_strassen | 128-129 | +100% | ‚≠ê‚≠ê –ú–µ–¥–ª–µ–Ω–Ω—ã–π |
| 6 | blocked_alphaevolve | 395-398 | +550% | ‚≠ê –û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–π |

### 5.2 –†–µ–∑—é–º–µ –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º:

| –ê–ª–≥–æ—Ä–∏—Ç–º | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|----------|------------|-------------------|--------------|-----------|
| **Naive** | Baseline, –º–∞–ª—ã–µ —Ä–∞–∑–º–µ—Ä—ã | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –ü—Ä–æ—Å—Ç–∞—è |
| **Strassen** | –û—á–µ–Ω—å –±–æ–ª—å—à–∏–µ n > 5000 | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | –°–ª–æ–∂–Ω–∞—è |
| **Strassen 4√ó4** | –¢–æ–ª—å–∫–æ 4√ó4, –±–∞–∑–∞ –¥–ª—è —Ä–µ–∫—É—Ä—Å–∏–∏ | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –°—Ä–µ–¥–Ω—è—è |
| **Winograd 4√ó4** | –¢–æ–ª—å–∫–æ 4√ó4 | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –ü—Ä–æ—Å—Ç–∞—è |
| **AlphaEvolve 4√ó4** | ‚ùå –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | ‚≠ê | ‚≠ê (complex) | –°–ª–æ–∂–Ω–∞—è |
| **Blocked Winograd** | **Production** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –°—Ä–µ–¥–Ω—è—è |
| **Blocked Strassen** | ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | ‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | –û—á–µ–Ω—å —Å–ª–æ–∂–Ω–∞—è |
| **BLAS (—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏)** | –í—Å–µ–≥–¥–∞ –≤ production | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê+ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –û—á–µ–Ω—å —Å–ª–æ–∂–Ω–∞—è |

### 5.3 –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

**–î–ª—è production –∫–æ–¥–∞:**
1. ‚úÖ **BLAS** (Intel MKL, OpenBLAS, Apple Accelerate) - –≤ 10-100x –±—ã—Å—Ç—Ä–µ–µ
2. ‚úÖ **Blocked Winograd** - –µ—Å–ª–∏ –Ω–µ–ª—å–∑—è BLAS (–Ω–∞ 10-15% –±—ã—Å—Ç—Ä–µ–µ naive)
3. ‚úÖ **Naive —Å -O2** - –ø—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π baseline

**–î–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π:**
1. ‚úÖ **Winograd** - —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ, –ø—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
2. ‚ö†Ô∏è **Strassen** - –∏–Ω—Ç–µ—Ä–µ—Å–µ–Ω —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏, –Ω–æ –Ω–µ–ø—Ä–∞–∫—Ç–∏—á–µ–Ω –¥–æ n > 5000
3. ‚ùå **AlphaEvolve** - —Ç–æ–ª—å–∫–æ –¥–ª—è double –≤—Ö–æ–¥–æ–≤, –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–π

**–ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚ùå **Blocked Strassen** - –¥–≤–æ–π–Ω–æ–π overhead —É–±–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚ùå **AlphaEvolve** –¥–ª—è complex –≤—Ö–æ–¥–æ–≤ - —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 5.4 –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞:

#### ‚úÖ –ß—Ç–æ –º—ã —É–∑–Ω–∞–ª–∏:

**1. –ú–µ–Ω—å—à–µ —É–º–Ω–æ–∂–µ–Ω–∏–π ‚â† –±—ã—Å—Ç—Ä–µ–µ:**
- Winograd: -25% mul ‚Üí **+10-15% —Å–∫–æ—Ä–æ—Å—Ç—å** ‚úì
- Strassen: -61% mul ‚Üí **-13% —Å–∫–æ—Ä–æ—Å—Ç—å** ‚úó
- AlphaEvolve: -25% mul ‚Üí **-550% —Å–∫–æ—Ä–æ—Å—Ç—å** ‚úó‚úó
- **Overhead –∫—Ä–∏—Ç–∏—á–Ω–µ–µ –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∏!**

**2. –ü—Ä–æ—Å—Ç–æ—Ç–∞ > —Å–ª–æ–∂–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ—Å—Ç–æ–π Winograd **–ø–æ–±–µ–∂–¥–∞–µ—Ç** —Å–ª–æ–∂–Ω—ã–π Strassen
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ª—É—á—à–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –∫–æ–¥
- –ú–µ–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏ = –ª—É—á—à–µ cache

**3. Memory access patterns —Ä–µ—à–∞—é—Ç:**
- –ë–ª–æ–∫–∏ 4√ó4 –≤ L1 –∫—ç—à–µ ‚Üí **+10-15% —Å–∫–æ—Ä–æ—Å—Ç—å**
- –†–µ–∫—É—Ä—Å–∏—è + —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è ‚Üí **-100% —Å–∫–æ—Ä–æ—Å—Ç—å**
- 65K –∞–ª–ª–æ–∫–∞—Ü–∏–π (blocked Strassen) ‚Üí –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞

**4. Strassen –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:**
- **–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** 186 ms (—Ä–µ–∫—É—Ä—Å–∏—è –¥–æ 1√ó1)
- **–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** 68-75 ms (–±–∞–∑–∞ 4√ó4)
- **–£–ª—É—á—à–µ–Ω–∏–µ: 2.5x!**
- **–ù–æ:** –í—Å–µ –µ—â–µ –º–µ–¥–ª–µ–Ω–Ω–µ–µ naive –∏–∑-–∑–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ overhead

**5. Hardware –≤–∞–∂–Ω–µ–µ —Ç–µ–æ—Ä–∏–∏:**
- Compiler optimization (SIMD, FMA) –¥–∞–µ—Ç –æ–≥—Ä–æ–º–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ
- –ü—Ä–æ—Å—Ç—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ª—É—á—à–µ –≤–µ–∫—Ç–æ—Ä–∏–∑—É—é—Ç—Å—è
- BLAS –ø–æ–±–µ–∂–¥–∞–µ—Ç –≤—Å–µ—Ö –±–ª–∞–≥–æ–¥–∞—Ä—è —Ä—É—á–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 5.5 –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π:

1. **SIMD Winograd:** –†—É—á–Ω–∞—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ‚Üí –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª 30-50% —É—Å–∫–æ—Ä–µ–Ω–∏–µ
2. **Multi-threaded blocked:** –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º –ø–æ –±–ª–æ–∫–∞–º ‚Üí 4-8x —É—Å–∫–æ—Ä–µ–Ω–∏–µ
3. **–ì–∏–±—Ä–∏–¥–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã:** Winograd –¥–ª—è –º–∞–ª—ã—Ö, Strassen –¥–ª—è –æ–≥—Ä–æ–º–Ω—ã—Ö
4. **Strassen –±–µ–∑ overhead:** –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –∞–ª–ª–æ–∫–∞—Ü–∏–π
5. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å BLAS:** Benchmark –ø—Ä–æ—Ç–∏–≤ MKL/OpenBLAS

---

## 6. –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã:
- `alg_naive.h` - –ù–∞–∏–≤–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ O(n¬≥)
- `alg_strassen.h` - –ê–ª–≥–æ—Ä–∏—Ç–º –®—Ç—Ä–∞—Å—Å–µ–Ω–∞ O(n^2.807) —Å –±–∞–∑–æ–π 4√ó4 ‚≠ê –£–õ–£–ß–®–ï–ù
- `alg_strassen_4x4.h` - Strassen –¥–ª—è 4√ó4 (7 —É–º–Ω–æ–∂–µ–Ω–∏–π 2√ó2 –±–ª–æ–∫–æ–≤) ‚≠ê –ù–û–í–´–ô
- `alg_winograd_4x4.h` - Winograd –¥–ª—è 4√ó4 (48 —É–º–Ω–æ–∂–µ–Ω–∏–π)
- `alg_alpha_evolve_4x4_complex.h` - AlphaEvolve —á–µ—Ä–µ–∑ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —á–∏—Å–ª–∞
- `alg_blocked.h` - –ë–ª–æ—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ —Å 4 —è–¥—Ä–∞–º–∏ (naive/winograd/alphaevolve/strassen) ‚≠ê –û–ë–ù–û–í–õ–ï–ù

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
- `structures.h` - Matrix, MatrixView, OpCounter
- `generators.h` - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –º–∞—Ç—Ä–∏—Ü (random, symmetric, sparse)
- `benchmark.h` - –°–∏—Å—Ç–µ–º–∞ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤
- `rss.h` - –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ (macOS)
- `main.cpp` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –±–µ–Ω—á–º–∞—Ä–∫–æ–≤

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- `benchmark_results.csv` - **132 –±–µ–Ω—á–º–∞—Ä–∫–∞** (—Ä–∞–∑–º–µ—Ä—ã 4-256, double/complex, random/symmetric)
- `ANALYSIS.md` - –≠—Ç–æ—Ç –æ—Ç—á—ë—Ç (–æ–±–Ω–æ–≤–ª–µ–Ω —Å –Ω–æ–≤—ã–º–∏ Strassen –º–µ—Ç—Ä–∏–∫–∞–º–∏)
- `WINOGRAD_VS_STRASSEN.md` - –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ—á–µ–º—É Winograd –±—ã—Å—Ç—Ä–µ–µ

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü, –≤–∫–ª—é—á–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é Strassen —Å –±–∞–∑–æ–≤—ã–º —Å–ª—É—á–∞–µ–º 4√ó4. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –ø–æ–∫–∞–∑–∞–ª–∏:

**–ì–ª–∞–≤–Ω—ã–π –≤—ã–≤–æ–¥:** **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –ø–æ–±–µ–∂–¥–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å.**

**Blocked Winograd** - **–õ–£–ß–®–ò–ô –∞–ª–≥–æ—Ä–∏—Ç–º** –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞–∑–º–µ—Ä–æ–≤:
- –ù–∞ 10-15% –±—ã—Å—Ç—Ä–µ–µ naive
- –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –û—Ç–ª–∏—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
- –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

**Strassen** - —É–ª—É—á—à–µ–Ω –≤ 2.5x, –Ω–æ –≤—Å–µ –µ—â–µ —É—Å—Ç—É–ø–∞–µ—Ç:
- –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π overhead (—Ä–µ–∫—É—Ä—Å–∏—è, –ø–∞–º—è—Ç—å) –ø–µ—Ä–µ–≤–µ—à–∏–≤–∞–µ—Ç —ç–∫–æ–Ω–æ–º–∏—é —É–º–Ω–æ–∂–µ–Ω–∏–π
- –ò–º–µ–µ—Ç —Å–º—ã—Å–ª —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–≥—Ä–æ–º–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü (n > 5000)
- Blocked Strassen - –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞ (–¥–≤–æ–π–Ω–æ–π overhead)

**AlphaEvolve** - —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –∏–Ω—Ç–µ—Ä–µ—Å–µ–Ω, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω:
- –û–≥—Ä–æ–º–Ω—ã–π overhead –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
- –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤
- –í 6.5x –º–µ–¥–ª–µ–Ω–Ω–µ–µ naive

–î–ª—è **production –∫–æ–¥–∞** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **BLAS** (MKL/OpenBLAS) –∏–ª–∏ **blocked Winograd** –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç.

**–ü–æ–ª—É—á–µ–Ω–Ω—ã–π –æ–ø—ã—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç:** –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã cache locality, compiler optimization, –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead - –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞.
